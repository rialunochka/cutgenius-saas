<!DOCTYPE html>
<html>
<head><title>Clips</title></head>
<body style="background-color:#fff8dc;">
  <h1 style="color:#e6b800;">Your AI-Cut Clips</h1>
  {% if clips %}
  <table border="1">
    <tr><th>Clip</th><th>Preview</th><th>Subtitle</th><th>Language</th><th>Save</th></tr>
    {% for clip in clips %}
    <tr>
      <td>{{ clip.file_name }}</td>
      <td><video width="200" controls><source src="{{ url_for('static', filename='clips/' + clip.file_name) }}" type="video/mp4"></video></td>
      <td><textarea name="subtitle_{{ loop.index }}" rows="2" cols="40">{{ clip.subtitle or '' }}</textarea></td>
      <td>
        <select name="lang_{{ loop.index }}">
          <option value="en" {% if clip.lang == 'en' %}selected{% endif %}>English</option>
          <option value="ru" {% if clip.lang == 'ru' %}selected{% endif %}>Russian</option>
          <option value="es" {% if clip.lang == 'es' %}selected{% endif %}>Spanish</option>
          <option value="fr" {% if clip.lang == 'fr' %}selected{% endif %}>French</option>
          <option value="de" {% if clip.lang == 'de' %}selected{% endif %}>German</option>
          <option value="uk" {% if clip.lang == 'uk' %}selected{% endif %}>Ukrainian</option>
          <option value="it" {% if clip.lang == 'it' %}selected{% endif %}>Italian</option>
          <option value="zh" {% if clip.lang == 'zh' %}selected{% endif %}>Chinese</option>
        </select>
      </td>
      <td><button onclick="saveSubtitle({{ loop.index }}, '{{ clip.file_name }}')">Save</button></td>
    </tr>
    {% endfor %}
  </table>
  {% else %}
  <p>No clips yet. Upload a video first.</p>
  {% endif %}

<script>
function saveSubtitle(index, filename) {
  const subtitle = document.querySelector(`textarea[name="subtitle_${index}"]`).value;
  const lang = document.querySelector(`select[name="lang_${index}"]`).value;

  fetch('/save_subtitle', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ filename, subtitle, lang })
  })
  .then(res => res.json())
  .then(data => alert(data.message));
}
</script>
</body>
</html>
